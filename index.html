<!DOCTYPE html>
<html>
<head>
  <title>LINE GPS æ‰“å¡</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h2>ğŸ”’ æ­£åœ¨é©—è­‰å®šä½...</h2>
  <script>
    const COMPANY_LAT = 25.0497652;
    const COMPANY_LNG = 121.2855485;
    const RADIUS_KM = 0.2;

    function getDistance(lat1, lon1, lat2, lon2) {
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLon = (lon2 - lon1) * Math.PI / 180;
      const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180) * Math.cos(lat2*Math.PI/180) * Math.sin(dLon/2)**2;
      return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    }

    async function main() {
      await liff.init({ liffId: "ä½ çš„LIFF ID" }); // ğŸ‘ˆ ç­‰ä½ æœ‰ LIFF ID å†è²¼
      navigator.geolocation.getCurrentPosition(async position => {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const dist = getDistance(lat, lng, COMPANY_LAT, COMPANY_LNG);
        const isInRange = dist <= RADIUS_KM;
        alert(isInRange ? 'âœ… æ‰“å¡æˆåŠŸ' : 'âŒ è¶…å‡ºç¯„åœï¼Œè«‹é è¿‘å…¬å¸å†æ‰“å¡');
        liff.closeWindow();
      }, () => {
        alert("â— è«‹é–‹å•Ÿ GPS ä»¥å®Œæˆæ‰“å¡");
      });
    }

    main();
  </script>
</body>
</html>
